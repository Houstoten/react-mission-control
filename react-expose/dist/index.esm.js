import e,{createContext as t,useContext as n,useState as r,useEffect as o,useCallback as i,useRef as a,useLayoutEffect as c}from"react";var l=t({isActive:!1,activate:function(){},deactivate:function(){},registerWindow:function(){},unregisterWindow:function(){},windows:new Map,borderWidth:3,highlightedComponent:null,setHighlightedComponent:function(){}}),u=function(){return n(l)},s=function(t){var n=t.children,u=t.shortcut,s=void 0===u?"Control+ArrowUp":u,d=t.onActivate,p=t.onDeactivate,y=t.blurAmount,w=void 0===y?10:y,v=r(!1),f=v[0],m=v[1],h=r(new Map),b=h[0],x=h[1],g=r(3),C=g[0],E=g[1];o((function(){if(f){var e=window.innerWidth<768,t=window.innerWidth>=768&&window.innerWidth<1200,n=window.innerWidth>=1200;e?E(4):t?E(3):n&&E(2.5)}}),[f]);var L=i((function(){m(!0),null==d||d()}),[d]),k=i((function(){m(!1),null==p||p()}),[p]),A=i((function(e,t){x((function(n){var r=new Map(n);return r.set(e,t),r}))}),[]),S=i((function(e){x((function(t){var n=new Map(t);return n.delete(e),n}))}),[]),M=a(null),q=r(null),W=q[0],F=q[1];return o((function(){var e=function(e){var t;if(!f&&s.includes("+")){var n=s.split("+"),r=null===(t=n.pop())||void 0===t?void 0:t.toLowerCase(),o=n.map((function(e){return e.toLowerCase()})),i=e.key.toLowerCase()===(null==r?void 0:r.toLowerCase()),a=o.includes("control")===e.ctrlKey&&o.includes("alt")===e.altKey&&o.includes("shift")===e.shiftKey&&o.includes("meta")===e.metaKey;i&&a&&(e.preventDefault(),L())}else f||"arrowup"!==s.toLowerCase()||"arrowup"!==e.key.toLowerCase()||(e.preventDefault(),null!==M.current&&window.clearTimeout(M.current),M.current=window.setTimeout((function(){L(),M.current=null}),1e3));f&&"Escape"===e.key&&(e.preventDefault(),k())},t=function(e){f||"arrowup"!==s.toLowerCase()||"arrowup"!==e.key.toLowerCase()||null!==M.current&&(window.clearTimeout(M.current),M.current=null)};return window.addEventListener("keydown",e),window.addEventListener("keyup",t),function(){null!==M.current&&window.clearTimeout(M.current),window.removeEventListener("keydown",e),window.removeEventListener("keyup",t)}}),[f,L,k,s]),c((function(){if(f){var e,t={current:null},n=null;return e=requestAnimationFrame((function(){var e=document.createElement("div");t.current=e,e.className="expose-backdrop",e.style.position="fixed",e.style.top="0",e.style.left="0",e.style.width="100vw",e.style.height="100vh",e.style.backgroundColor="rgba(255, 255, 255, 0.1)",e.style.opacity="0",e.style.backdropFilter="blur(".concat(w,"px)"),e.style["-webkit-backdrop-filter"]="blur(".concat(w,"px)"),e.style.zIndex="9998",e.style.transition="opacity 0.2s ease",e.addEventListener("click",k),document.body.appendChild(e);var n=window.scrollY;document.body.style.position="fixed",document.body.style.top="-".concat(n,"px"),document.body.style.width="100%",document.body.style.overflowY="scroll",requestAnimationFrame((function(){e&&(e.style.opacity="1")}))})),function(){if(null!==e&&cancelAnimationFrame(e),t.current){var r=t.current;r.style.opacity="0";var o=-1*parseInt(document.body.style.top||"0",10);document.body.style.position="",document.body.style.top="",document.body.style.width="",document.body.style.overflowY="",window.scrollTo(0,o),n=window.setTimeout((function(){requestAnimationFrame((function(){r.parentNode===document.body&&document.body.removeChild(r)}))}),200)}null!==n&&window.clearTimeout(n)}}}),[f,k,w]),e.createElement(l.Provider,{value:{isActive:f,activate:L,deactivate:k,registerWindow:A,unregisterWindow:S,windows:b,borderWidth:C,setActive:m,highlightedComponent:W,setHighlightedComponent:F}},n)},d=function(){return d=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},d.apply(this,arguments)};"function"==typeof SuppressedError&&SuppressedError;var p=function(t){var n,i,l=t.children,s=t.id,p=t.className,y=void 0===p?"":p,w=t.style,v=void 0===w?{}:w,f=t.label,m=a(s||"expose-"+Math.random().toString(36).slice(2,11)),h=a(null),b=u(),x=b.isActive,g=b.registerWindow,C=b.unregisterWindow,E=b.borderWidth,L=a(null),k=r(null),A=k[0],S=k[1],M=b.highlightedComponent,q=b.setHighlightedComponent;o((function(){return g(m.current,h),function(){C(m.current),L.current&&(cancelAnimationFrame(L.current),L.current=null)}}),[g,C]);var W=a(null);return c((function(){if(x){if(!W.current){var e=document.createElement("div");e.className="expose-window-border-container";var t=document.createElement("div");t.className="expose-window-border-overlay";var n=document.createElement("div");n.className="expose-window-label",n.style.opacity="0",e.appendChild(t),e.appendChild(n),document.body.appendChild(e),W.current=e;h.current&&(h.current.addEventListener("mouseenter",(function(){if(W.current){var e=W.current.querySelector(".expose-window-border-overlay");e&&(e.classList.add("hover"),e.style.borderColor="rgba(64, 156, 255, 0.85)");var t=W.current.querySelector(".expose-window-label");t&&(t.style.opacity="1")}})),h.current.addEventListener("mouseleave",(function(){if(W.current){var e=W.current.querySelector(".expose-window-border-overlay");e&&(e.classList.remove("hover"),e.style.borderColor="transparent");var t=W.current.querySelector(".expose-window-label");t&&(t.style.opacity="0")}})))}return function(){if(W.current&&(document.body.removeChild(W.current),W.current=null),h.current){h.current.removeEventListener("mouseenter",(function(){if(W.current){var e=W.current.querySelector(".expose-window-border-overlay");e&&(e.classList.add("hover"),e.style.borderColor="rgba(64, 156, 255, 0.85)");var t=W.current.querySelector(".expose-window-label");t&&(t.style.opacity="1")}})),h.current.removeEventListener("mouseleave",(function(){if(W.current){var e=W.current.querySelector(".expose-window-border-overlay");e&&(e.classList.remove("hover"),e.style.borderColor="transparent");var t=W.current.querySelector(".expose-window-label");t&&(t.style.opacity="0")}}))}}}}),[x]),o((function(){if(M===m.current){var e=setTimeout((function(){q(null)}),500);return function(){clearTimeout(e)}}}),[M,m,q]),c((function(){if(h.current&&x){var e=function(){if(h.current){var e=h.current,t=e.getBoundingClientRect(),n=window.innerWidth,r=window.innerHeight,o=document.querySelectorAll(".expose-window"),i=o.length,a=n/r,c=Math.sqrt(i*a),l=Math.ceil(c),u=Math.ceil(i/l),s=Array.from(o).indexOf(e),d=s%l,p=Math.floor(s/l),y=.05*Math.min(n,r),w=(n-y*(l+1))/l,v=(r-y*(u+1))/u,m=t.width<200||t.height<150,b=t.width>.6*n||t.height>.6*r,x=w/t.width*.85,g=v/t.height*.85,C=Math.min(x,g);m&&C<.7&&(C=Math.max(C,.7)),b&&(C=Math.min(C,.25));var L=y+d*(w+y)+w/2,k=y+p*(v+y)+v/2,A=t.left+t.width/2,M=t.top+t.height/2,q=L-A,F=k-M,z=Math.round(q),T=Math.round(F),I=parseFloat(C.toFixed(3));if(S({transform:"translate(".concat(z,"px, ").concat(T,"px)"),scale:I,zIndex:1e4}),W.current){var N=t.width*I,D=t.height*I,H=A+z,O=M+T,K=Math.max(4,Math.min(12,14*(1-I))),R=.97*N+2*K,Y=.97*D+2*K;W.current.style.transform="none",W.current.style.width="".concat(R,"px"),W.current.style.height="".concat(Y,"px"),W.current.style.left="".concat(Math.round(H-R/2),"px"),W.current.style.top="".concat(Math.round(O-Y/2),"px"),W.current.style.position="fixed",W.current.style.pointerEvents="none",W.current.style.zIndex="10001",W.current.style.overflow="visible";var j=W.current.querySelector(".expose-window-border-overlay");j&&(j.style.position="absolute",j.style.top="0",j.style.left="0",j.style.width="100%",j.style.height="100%",j.style.borderWidth="".concat(E,"px"),j.style.borderStyle="solid",j.style.borderColor="transparent",j.style.borderRadius="6px",j.style.boxSizing="border-box",j.style.pointerEvents="none",j.style.transition="border-color 0.2s ease",j.classList.contains("hover")&&(j.style.borderColor="rgba(64, 156, 255, 0.85)"));var P=W.current.querySelector(".expose-window-label");P&&f&&(P.textContent=f,P.style.position="absolute",P.style.bottom="-30px",P.style.left="50%",P.style.transform="translateX(-50%)",P.style.height="auto",P.style.minHeight="fit-content",P.style.maxWidth="none",P.style.display="flex",P.style.alignItems="center",P.style.justifyContent="center",P.style.backgroundColor="rgba(0, 0, 0, 0.75)",P.style.color="white",P.style.padding="4px 8px",P.style.borderRadius="4px",P.style.fontSize="12px",P.style.fontWeight="bold",P.style.whiteSpace="nowrap",P.style.transition="opacity 0.2s ease",P.style.pointerEvents="none",P.style.zIndex="10002")}}};e();var t=function(){L.current&&cancelAnimationFrame(L.current),L.current=requestAnimationFrame(e)};return window.addEventListener("resize",t),function(){window.removeEventListener("resize",t),L.current&&(cancelAnimationFrame(L.current),L.current=null)}}L.current&&(cancelAnimationFrame(L.current),L.current=null)}),[x,E,f]),o((function(){if(x&&f&&W.current){var e=W.current.querySelector(".expose-window-label");e&&(e.textContent=f)}}),[x,f]),e.createElement("div",{className:"expose-container"},e.createElement("div",{ref:h,className:"expose-window ".concat(x?"expose-window-active":""," ").concat(M===m.current?"expose-window-highlighted":""," ").concat(y),onClick:x?function(e){e.stopPropagation(),h.current&&(b.setActive&&b.setActive(!1),q(m.current),requestAnimationFrame((function(){setTimeout((function(){if(h.current){var e=h.current.getBoundingClientRect(),t=window.scrollY+e.top-50;window.scrollTo({top:t,behavior:"smooth"})}}),200)})))}:void 0,style:d(d({},v),{transition:"transform 0.2s cubic-bezier(0.16, 1, 0.3, 1), opacity 0.2s ease, box-shadow 0.2s ease, filter 0.2s ease",transformOrigin:"center center",willChange:x||M===m.current?"transform, opacity, filter":"auto",zIndex:A&&x?A.zIndex:M===m.current?1e3:"auto",transform:A&&x?"translate(".concat((null===(n=A.transform.match(/translate\((.*?)px,/))||void 0===n?void 0:n[1])||0,"px, ").concat((null===(i=A.transform.match(/px,\s*(.*?)px\)/))||void 0===i?void 0:i[1])||0,"px) scale(").concat((null==A?void 0:A.scale)||1,")"):"none",background:x?void 0:"transparent",boxShadow:x?void 0:M===m.current?"0 0 0 4px rgba(64, 156, 255, 0.7), 0 5px 20px rgba(0, 0, 0, 0.2)":"none",width:"100%",height:"100%",pointerEvents:"auto",filter:M===m.current?"none":"blur(0px)"}),"data-expose-id":m.current,"data-scale":(null==A?void 0:A.scale)||1,"data-highlighted":M===m.current?"true":"false"},l))},y=function(){var e=u(),t=e.isActive,n=e.activate,r=e.deactivate,i=a(0);return o((function(){var e=function(e){if(!t&&"ArrowUp"===e.key){e.preventDefault();var r=Date.now();r-i.current<300?(n(),i.current=0):i.current=r}},o=function(e){t&&"Escape"===e.key&&(e.preventDefault(),r())};return window.addEventListener("keyup",e),window.addEventListener("keydown",o),function(){window.removeEventListener("keyup",e),window.removeEventListener("keydown",o)}}),[t,n,r]),null};export{s as ExposeProvider,y as ExposeTrigger,p as ExposeWrapper,u as useExpose};
//# sourceMappingURL=index.esm.js.map
