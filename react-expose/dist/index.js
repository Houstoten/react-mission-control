"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("react");function t(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var n=t(e),r=e.createContext({isActive:!1,activate:function(){},deactivate:function(){},registerWindow:function(){},unregisterWindow:function(){},windows:new Map,borderWidth:3,highlightedComponent:null,setHighlightedComponent:function(){}}),o=function(){return e.useContext(r)},i=function(){return i=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},i.apply(this,arguments)};"function"==typeof SuppressedError&&SuppressedError;exports.ExposeProvider=function(t){var o=t.children,i=t.shortcut,a=void 0===i?"Control+ArrowUp":i,c=t.onActivate,l=t.onDeactivate,u=t.blurAmount,s=void 0===u?10:u,d=e.useState(!1),p=d[0],y=d[1],f=e.useState(new Map),w=f[0],v=f[1],m=e.useState(3),h=m[0],b=m[1];e.useEffect((function(){if(p){var e=window.innerWidth<768,t=window.innerWidth>=768&&window.innerWidth<1200,n=window.innerWidth>=1200;e?b(4):t?b(3):n&&b(2.5)}}),[p]);var x=e.useCallback((function(){y(!0),null==c||c()}),[c]),g=e.useCallback((function(){y(!1),null==l||l()}),[l]),E=e.useCallback((function(e,t){v((function(n){var r=new Map(n);return r.set(e,t),r}))}),[]),C=e.useCallback((function(e){v((function(t){var n=new Map(t);return n.delete(e),n}))}),[]),L=e.useRef(null),k=e.useState(null),S=k[0],A=k[1];return e.useEffect((function(){var e=function(e){var t;if(!p&&a.includes("+")){var n=a.split("+"),r=null===(t=n.pop())||void 0===t?void 0:t.toLowerCase(),o=n.map((function(e){return e.toLowerCase()})),i=e.key.toLowerCase()===(null==r?void 0:r.toLowerCase()),c=o.includes("control")===e.ctrlKey&&o.includes("alt")===e.altKey&&o.includes("shift")===e.shiftKey&&o.includes("meta")===e.metaKey;i&&c&&(e.preventDefault(),x())}else p||"arrowup"!==a.toLowerCase()||"arrowup"!==e.key.toLowerCase()||(e.preventDefault(),null!==L.current&&window.clearTimeout(L.current),L.current=window.setTimeout((function(){x(),L.current=null}),1e3));p&&"Escape"===e.key&&(e.preventDefault(),g())},t=function(e){p||"arrowup"!==a.toLowerCase()||"arrowup"!==e.key.toLowerCase()||null!==L.current&&(window.clearTimeout(L.current),L.current=null)};return window.addEventListener("keydown",e),window.addEventListener("keyup",t),function(){null!==L.current&&window.clearTimeout(L.current),window.removeEventListener("keydown",e),window.removeEventListener("keyup",t)}}),[p,x,g,a]),e.useLayoutEffect((function(){if(p){var e,t={current:null},n=null;return e=requestAnimationFrame((function(){var e=document.createElement("div");t.current=e,e.className="expose-backdrop",e.style.position="fixed",e.style.top="0",e.style.left="0",e.style.width="100vw",e.style.height="100vh",e.style.backgroundColor="rgba(255, 255, 255, 0.1)",e.style.opacity="0",e.style.backdropFilter="blur(".concat(s,"px)"),e.style["-webkit-backdrop-filter"]="blur(".concat(s,"px)"),e.style.zIndex="9998",e.style.transition="opacity 0.2s ease",e.addEventListener("click",g),document.body.appendChild(e);var n=window.scrollY;document.body.style.position="fixed",document.body.style.top="-".concat(n,"px"),document.body.style.width="100%",document.body.style.overflowY="scroll",requestAnimationFrame((function(){e&&(e.style.opacity="1")}))})),function(){if(null!==e&&cancelAnimationFrame(e),t.current){var r=t.current;r.style.opacity="0";var o=-1*parseInt(document.body.style.top||"0",10);document.body.style.position="",document.body.style.top="",document.body.style.width="",document.body.style.overflowY="",window.scrollTo(0,o),n=window.setTimeout((function(){requestAnimationFrame((function(){r.parentNode===document.body&&document.body.removeChild(r)}))}),200)}null!==n&&window.clearTimeout(n)}}}),[p,g,s]),n.default.createElement(r.Provider,{value:{isActive:p,activate:x,deactivate:g,registerWindow:E,unregisterWindow:C,windows:w,borderWidth:h,setActive:y,highlightedComponent:S,setHighlightedComponent:A}},o)},exports.ExposeTrigger=function(){var t=o(),n=t.isActive,r=t.activate,i=t.deactivate,a=e.useRef(0);return e.useEffect((function(){var e=function(e){if(!n&&"ArrowUp"===e.key){e.preventDefault();var t=Date.now();t-a.current<300?(r(),a.current=0):a.current=t}},t=function(e){n&&"Escape"===e.key&&(e.preventDefault(),i())};return window.addEventListener("keyup",e),window.addEventListener("keydown",t),function(){window.removeEventListener("keyup",e),window.removeEventListener("keydown",t)}}),[n,r,i]),null},exports.ExposeWrapper=function(t){var r,a,c=t.children,l=t.id,u=t.className,s=void 0===u?"":u,d=t.style,p=void 0===d?{}:d,y=t.label,f=e.useRef(l||"expose-"+Math.random().toString(36).slice(2,11)),w=e.useRef(null),v=o(),m=v.isActive,h=v.registerWindow,b=v.unregisterWindow,x=v.borderWidth,g=e.useRef(null),E=e.useState(null),C=E[0],L=E[1],k=v.highlightedComponent,S=v.setHighlightedComponent;e.useEffect((function(){return h(f.current,w),function(){b(f.current),g.current&&(cancelAnimationFrame(g.current),g.current=null)}}),[h,b]);var A=e.useRef(null);return e.useLayoutEffect((function(){if(m){if(!A.current){var e=document.createElement("div");e.className="expose-window-border-container";var t=document.createElement("div");t.className="expose-window-border-overlay";var n=document.createElement("div");n.className="expose-window-label",n.style.opacity="0",e.appendChild(t),e.appendChild(n),document.body.appendChild(e),A.current=e;w.current&&(w.current.addEventListener("mouseenter",(function(){if(A.current){var e=A.current.querySelector(".expose-window-border-overlay");e&&(e.classList.add("hover"),e.style.borderColor="rgba(64, 156, 255, 0.85)");var t=A.current.querySelector(".expose-window-label");t&&(t.style.opacity="1")}})),w.current.addEventListener("mouseleave",(function(){if(A.current){var e=A.current.querySelector(".expose-window-border-overlay");e&&(e.classList.remove("hover"),e.style.borderColor="transparent");var t=A.current.querySelector(".expose-window-label");t&&(t.style.opacity="0")}})))}return function(){if(A.current&&(document.body.removeChild(A.current),A.current=null),w.current){w.current.removeEventListener("mouseenter",(function(){if(A.current){var e=A.current.querySelector(".expose-window-border-overlay");e&&(e.classList.add("hover"),e.style.borderColor="rgba(64, 156, 255, 0.85)");var t=A.current.querySelector(".expose-window-label");t&&(t.style.opacity="1")}})),w.current.removeEventListener("mouseleave",(function(){if(A.current){var e=A.current.querySelector(".expose-window-border-overlay");e&&(e.classList.remove("hover"),e.style.borderColor="transparent");var t=A.current.querySelector(".expose-window-label");t&&(t.style.opacity="0")}}))}}}}),[m]),e.useEffect((function(){if(k===f.current){var e=setTimeout((function(){S(null)}),500);return function(){clearTimeout(e)}}}),[k,f,S]),e.useLayoutEffect((function(){if(w.current&&m){var e=function(){if(w.current){var e=w.current,t=e.getBoundingClientRect(),n=window.innerWidth,r=window.innerHeight,o=document.querySelectorAll(".expose-window"),i=o.length,a=n/r,c=Math.sqrt(i*a),l=Math.ceil(c),u=Math.ceil(i/l),s=Array.from(o).indexOf(e),d=s%l,p=Math.floor(s/l),f=.05*Math.min(n,r),v=(n-f*(l+1))/l,m=(r-f*(u+1))/u,h=t.width<200||t.height<150,b=t.width>.6*n||t.height>.6*r,g=v/t.width*.85,E=m/t.height*.85,C=Math.min(g,E);h&&C<.7&&(C=Math.max(C,.7)),b&&(C=Math.min(C,.25));var k=f+d*(v+f)+v/2,S=f+p*(m+f)+m/2,M=t.left+t.width/2,q=t.top+t.height/2,W=k-M,F=S-q,T=Math.round(W),z=Math.round(F),R=parseFloat(C.toFixed(3));if(L({transform:"translate(".concat(T,"px, ").concat(z,"px)"),scale:R,zIndex:1e4}),A.current){var I=t.width*R,N=t.height*R,D=M+T,O=q+z,j=Math.max(4,Math.min(12,14*(1-R))),H=.97*I+2*j,P=.97*N+2*j;A.current.style.transform="none",A.current.style.width="".concat(H,"px"),A.current.style.height="".concat(P,"px"),A.current.style.left="".concat(Math.round(D-H/2),"px"),A.current.style.top="".concat(Math.round(O-P/2),"px"),A.current.style.position="fixed",A.current.style.pointerEvents="none",A.current.style.zIndex="10001",A.current.style.overflow="visible";var K=A.current.querySelector(".expose-window-border-overlay");K&&(K.style.position="absolute",K.style.top="0",K.style.left="0",K.style.width="100%",K.style.height="100%",K.style.borderWidth="".concat(x,"px"),K.style.borderStyle="solid",K.style.borderColor="transparent",K.style.borderRadius="6px",K.style.boxSizing="border-box",K.style.pointerEvents="none",K.style.transition="border-color 0.2s ease",K.classList.contains("hover")&&(K.style.borderColor="rgba(64, 156, 255, 0.85)"));var Y=A.current.querySelector(".expose-window-label");Y&&y&&(Y.textContent=y,Y.style.position="absolute",Y.style.bottom="-30px",Y.style.left="50%",Y.style.transform="translateX(-50%)",Y.style.height="auto",Y.style.minHeight="fit-content",Y.style.maxWidth="none",Y.style.display="flex",Y.style.alignItems="center",Y.style.justifyContent="center",Y.style.backgroundColor="rgba(0, 0, 0, 0.75)",Y.style.color="white",Y.style.padding="4px 8px",Y.style.borderRadius="4px",Y.style.fontSize="12px",Y.style.fontWeight="bold",Y.style.whiteSpace="nowrap",Y.style.transition="opacity 0.2s ease",Y.style.pointerEvents="none",Y.style.zIndex="10002")}}};e();var t=function(){g.current&&cancelAnimationFrame(g.current),g.current=requestAnimationFrame(e)};return window.addEventListener("resize",t),function(){window.removeEventListener("resize",t),g.current&&(cancelAnimationFrame(g.current),g.current=null)}}g.current&&(cancelAnimationFrame(g.current),g.current=null)}),[m,x,y]),e.useEffect((function(){if(m&&y&&A.current){var e=A.current.querySelector(".expose-window-label");e&&(e.textContent=y)}}),[m,y]),n.default.createElement("div",{className:"expose-container"},n.default.createElement("div",{ref:w,className:"expose-window ".concat(m?"expose-window-active":""," ").concat(k===f.current?"expose-window-highlighted":""," ").concat(s),onClick:m?function(e){e.stopPropagation(),w.current&&(v.setActive&&v.setActive(!1),S(f.current),requestAnimationFrame((function(){setTimeout((function(){if(w.current){var e=w.current.getBoundingClientRect(),t=window.scrollY+e.top-50;window.scrollTo({top:t,behavior:"smooth"})}}),200)})))}:void 0,style:i(i({},p),{transition:"transform 0.2s cubic-bezier(0.16, 1, 0.3, 1), opacity 0.2s ease, box-shadow 0.2s ease, filter 0.2s ease",transformOrigin:"center center",willChange:m||k===f.current?"transform, opacity, filter":"auto",zIndex:C&&m?C.zIndex:k===f.current?1e3:"auto",transform:C&&m?"translate(".concat((null===(r=C.transform.match(/translate\((.*?)px,/))||void 0===r?void 0:r[1])||0,"px, ").concat((null===(a=C.transform.match(/px,\s*(.*?)px\)/))||void 0===a?void 0:a[1])||0,"px) scale(").concat((null==C?void 0:C.scale)||1,")"):"none",background:m?void 0:"transparent",boxShadow:m?void 0:k===f.current?"0 0 0 4px rgba(64, 156, 255, 0.7), 0 5px 20px rgba(0, 0, 0, 0.2)":"none",width:"100%",height:"100%",pointerEvents:"auto",filter:k===f.current?"none":"blur(0px)"}),"data-expose-id":f.current,"data-scale":(null==C?void 0:C.scale)||1,"data-highlighted":k===f.current?"true":"false"},c))},exports.useExpose=o;
//# sourceMappingURL=index.js.map
